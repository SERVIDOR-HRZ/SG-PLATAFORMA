<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Pruebas - Seamos Genios</title>

    <!-- Security headers -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="../Elementos/css/panel.css">
    <link rel="stylesheet" href="../Elementos/css/pruebas.css">
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <button class="back-btn" id="backBtn">
                <i class="bi bi-arrow-left"></i>
                Volver
            </button>
            <img src="../Elementos/img/logo1.png" alt="Seamos Genios Logo" class="header-logo">
            <h1 id="pageTitle">Gestión de Pruebas</h1>
        </div>
        <div class="header-right">
            <div class="user-info">
                <span class="user-name" id="userName">USUARIO</span>
                <div class="user-avatar">
                    <i class="bi bi-person-fill"></i>
                </div>
            </div>
            <button class="logout-btn" id="logoutBtn">
                <i class="bi bi-box-arrow-right"></i>
                Cerrar Sesión
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Admin View -->
        <div id="adminView" class="admin-view">
            <!-- Action Buttons -->
            <div class="action-buttons">
                <button class="btn btn-primary" id="createTestBtn">
                    <i class="bi bi-plus-circle"></i>
                    Crear Nueva Prueba
                </button>
            </div>

            <!-- Tests List -->
            <div class="tests-container">
                <h2>Pruebas Creadas</h2>
                <div class="tests-list" id="testsList">
                    <!-- Tests will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Student View -->
        <div id="studentView" class="student-view" style="display: none;">
            <div class="assigned-tests">
                <h2>Mis Pruebas Asignadas</h2>
                <div class="student-tests-list" id="studentTestsList">
                    <!-- Student tests will be loaded here -->
                </div>
            </div>
        </div>
    </main>

    <!-- Create Test Modal -->
    <div class="modal-overlay" id="createTestModal">
        <div class="modal">
            <div class="modal-header">
                <h3>Crear Nueva Prueba</h3>
                <button class="close-btn" id="closeCreateModal">
                    <i class="bi bi-x"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="createTestForm">
                    <div class="form-group">
                        <label for="testName">Nombre de la Prueba</label>
                        <input type="text" id="testName" name="testName" required>
                    </div>

                    <div class="form-group">
                        <label for="testDate">Fecha de la Prueba</label>
                        <input type="date" id="testDate" name="testDate" required>
                    </div>

                    <div class="form-group">
                        <label for="assignedStudents">Estudiantes Asignados</label>
                        <div class="students-selector" id="studentsSelector">
                            <div class="select-all-container">
                                <input type="checkbox" id="selectAllStudents">
                                <label for="selectAllStudents">Seleccionar Todos</label>
                            </div>
                            <div class="students-counter" id="studentsCounter">
                                0 estudiantes seleccionados
                            </div>
                            <div class="students-list" id="studentsList">
                                <!-- Students will be loaded here -->
                            </div>
                        </div>
                    </div>

                    <div class="blocks-container">
                        <h4>Configuración de Bloques</h4>

                        <!-- Bloque 1 -->
                        <div class="block-config">
                            <h5>Bloque 1</h5>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="block1StartTime">Hora de Inicio</label>
                                    <input type="time" id="block1StartTime" name="block1StartTime" required>
                                </div>
                                <div class="form-group">
                                    <label for="block1EndTime">Hora de Fin</label>
                                    <input type="time" id="block1EndTime" name="block1EndTime" required>
                                </div>
                            </div>
                        </div>

                        <!-- Bloque 2 -->
                        <div class="block-config">
                            <h5>Bloque 2</h5>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="block2StartTime">Hora de Inicio</label>
                                    <input type="time" id="block2StartTime" name="block2StartTime" required>
                                </div>
                                <div class="form-group">
                                    <label for="block2EndTime">Hora de Fin</label>
                                    <input type="time" id="block2EndTime" name="block2EndTime" required>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" id="cancelCreateTest">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Crear Prueba</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Edit Test Modal -->
    <div class="modal-overlay" id="editTestModal">
        <div class="modal">
            <div class="modal-header">
                <h3>Editar Prueba</h3>
                <button class="close-btn" id="closeEditModal">
                    <i class="bi bi-x"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="editTestForm">
                    <input type="hidden" id="editTestId" name="editTestId">

                    <div class="form-group">
                        <label for="editTestName">Nombre de la Prueba</label>
                        <input type="text" id="editTestName" name="editTestName" required>
                    </div>

                    <div class="form-group">
                        <label for="editTestDate">Fecha de la Prueba</label>
                        <input type="date" id="editTestDate" name="editTestDate" required>
                    </div>

                    <div class="form-group">
                        <label for="editAssignedStudents">Estudiantes Asignados</label>
                        <div class="students-selector" id="editStudentsSelector">
                            <div class="select-all-container">
                                <input type="checkbox" id="editSelectAllStudents">
                                <label for="editSelectAllStudents">Seleccionar Todos</label>
                            </div>
                            <div class="students-counter" id="editStudentsCounter">
                                0 estudiantes seleccionados
                            </div>
                            <div class="students-list" id="editStudentsList">
                                <!-- Students will be loaded here -->
                            </div>
                        </div>
                    </div>

                    <div class="blocks-container">
                        <h4>Configuración de Bloques</h4>

                        <!-- Bloque 1 -->
                        <div class="block-config">
                            <h5>Bloque 1</h5>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="editBlock1StartTime">Hora de Inicio</label>
                                    <input type="time" id="editBlock1StartTime" name="editBlock1StartTime" required>
                                </div>
                                <div class="form-group">
                                    <label for="editBlock1EndTime">Hora de Fin</label>
                                    <input type="time" id="editBlock1EndTime" name="editBlock1EndTime" required>
                                </div>
                            </div>
                        </div>

                        <!-- Bloque 2 -->
                        <div class="block-config">
                            <h5>Bloque 2</h5>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="editBlock2StartTime">Hora de Inicio</label>
                                    <input type="time" id="editBlock2StartTime" name="editBlock2StartTime" required>
                                </div>
                                <div class="form-group">
                                    <label for="editBlock2EndTime">Hora de Fin</label>
                                    <input type="time" id="editBlock2EndTime" name="editBlock2EndTime" required>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" id="cancelEditTest">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Actualizar Prueba</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Firebase CDN -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <script src="../Elementos/js/config.js"></script>
    <script src="../Elementos/js/pruebas-admin.js"></script>
</body>

</html>