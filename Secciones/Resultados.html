<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Consulta tus resultados y progreso académico en Seamos Genios">
    <title>Mis Resultados - Seamos Genios</title>

    <!-- Security headers -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">

    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://www.gstatic.com">

    <!-- Fonts and Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="../Elementos/css/resultados.css">
    <link rel="shortcut icon" href="../Elementos/img/logo1.png" type="image/x-icon">
</head>

<body>
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" id="mobileMenuToggle" style="display: none;"
        aria-label="Abrir menú de navegación">
        <i class="bi bi-chevron-right"></i>
    </button>

    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay" aria-hidden="true"></div>

    <!-- Sidebar Panel -->
    <aside class="sidebar-panel" id="sidebarPanel" role="navigation" aria-label="Menú principal">
        <!-- Perfil Usuario -->
        <div class="sidebar-profile">
            <div class="sidebar-avatar" id="userAvatarContainer">
                <div class="sidebar-avatar-default" id="userAvatarDefault" aria-hidden="true">
                    <i class="bi bi-person-fill"></i>
                </div>
                <img class="sidebar-avatar-image" id="userAvatarImage" style="display: none;" src=""
                    alt="Foto de perfil del usuario">
            </div>
            <div class="sidebar-user-name" id="userName" role="heading" aria-level="2">Usuario</div>
            <div class="sidebar-user-role" id="userRole">Panel de Resultados</div>

            <!-- Botones de Perfil y Web -->
            <div class="sidebar-profile-actions">
                <button class="sidebar-btn btn-profile" id="btnProfile" aria-label="Ir a mi perfil">
                    <i class="bi bi-person-gear" aria-hidden="true"></i>
                    <span>Mi Perfil</span>
                </button>
                <button class="sidebar-btn btn-home" id="btnHome" aria-label="Ir a la página principal">
                    <i class="bi bi-house-door-fill" aria-hidden="true"></i>
                    <span>Web Principal</span>
                </button>
                <button class="sidebar-btn btn-back" id="btnBack" aria-label="Volver al panel anterior">
                    <i class="bi bi-arrow-left-circle-fill" aria-hidden="true"></i>
                    <span>Volver al Panel</span>
                </button>
            </div>
        </div>

        <!-- Botones de Acción -->
        <div class="sidebar-actions">
            <button class="sidebar-btn btn-logout" id="btnLogout" aria-label="Cerrar sesión">
                <i class="bi bi-box-arrow-right" aria-hidden="true"></i>
                <span>Cerrar Sesión</span>
            </button>
        </div>
    </aside>

    <!-- Contenido Principal -->
    <main class="main-panel-content" role="main">
        <!-- Header -->
        <header class="panel-header">
            <div>
                <h1 class="panel-title" id="panelTitle">Mis Resultados</h1>
                <p class="panel-subtitle" id="panelSubtitle">Consulta tus resultados y progreso académico</p>
            </div>
            <div class="panel-time">
                <div class="time-display">
                    <i class="bi bi-sun-fill" id="timeIcon" aria-hidden="true"></i>
                    <time id="currentTime">3:02:47 PM</time>
                </div>
                <div class="date-display" id="currentDate">sábado, 17 de enero de 2026</div>
            </div>
        </header>

        <!-- Filtro de Estudiante (Solo Admin/Coordinador) -->
        <div class="admin-filter-container" id="adminFilterContainer" style="display: none;">
            <div class="admin-filter-header">
                <i class="bi bi-people-fill"></i>
                <span>Filtrar Resultados</span>
            </div>
            <div class="admin-filter-content">
                <!-- Filtro por Institución -->
                <div class="filter-group-admin">
                    <label for="filterInstitucionAdmin"><i class="bi bi-building"></i> Institución:</label>
                    <select id="filterInstitucionAdmin" class="filter-admin-select">
                        <option value="">-- Todas las instituciones --</option>
                    </select>
                </div>
                
                <!-- Buscador de Estudiante -->
                <div class="filter-group-admin search-estudiante-group">
                    <label for="searchEstudianteAdmin"><i class="bi bi-search"></i> Buscar estudiante:</label>
                    <input type="text" id="searchEstudianteAdmin" class="search-estudiante-input" 
                           placeholder="Escribir nombre o documento...">
                </div>
                
                <!-- Selector de Estudiante -->
                <div class="filter-group-admin">
                    <label for="filterEstudiante"><i class="bi bi-person"></i> Estudiante:</label>
                    <select id="filterEstudiante" class="filter-admin-select">
                        <option value="">-- Todos los estudiantes --</option>
                    </select>
                </div>
                
                <!-- Botón Limpiar Filtros -->
                <button class="btn-limpiar-filtros-admin" id="btnLimpiarFiltrosAdmin">
                    <i class="bi bi-arrow-clockwise"></i>
                    Limpiar Filtros
                </button>
                
                <!-- Estadísticas -->
                <div class="admin-stats-inline" id="adminStatsInline">
                    <div class="admin-stat">
                        <i class="bi bi-people"></i>
                        <div class="admin-stat-content">
                            <span id="totalEstudiantes">0</span>
                            <label>Estudiantes</label>
                        </div>
                    </div>
                    <div class="admin-stat">
                        <i class="bi bi-file-earmark-check"></i>
                        <div class="admin-stat-content">
                            <span id="totalRespuestas">0</span>
                            <label>Pruebas Respondidas</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Menú de Navegación -->
        <nav class="results-menu" role="tablist" aria-label="Navegación de resultados">
            <button class="menu-tab active" data-tab="pruebas" role="tab" aria-selected="true"
                aria-controls="pruebas-content">
                <i class="bi bi-file-earmark-text-fill" aria-hidden="true"></i>
                <span>Pruebas</span>
            </button>
            <button class="menu-tab" data-tab="minisimulacros" role="tab" aria-selected="false"
                aria-controls="minisimulacros-content">
                <i class="bi bi-clipboard-check-fill" aria-hidden="true"></i>
                <span>Minisimulacros</span>
            </button>
            <button class="menu-tab" data-tab="plan-estudio" role="tab" aria-selected="false"
                aria-controls="plan-estudio-content" id="tabPlanEstudio">
                <i class="bi bi-calendar-check-fill" aria-hidden="true"></i>
                <span>Plan de Estudio</span>
            </button>
            <!-- Tab solo para Admin: Ver Planes de Estudiantes -->
            <button class="menu-tab admin-only-tab" data-tab="planes-admin" role="tab" aria-selected="false"
                aria-controls="planes-admin-content" id="tabPlanesAdmin" style="display: none;">
                <i class="bi bi-people-fill" aria-hidden="true"></i>
                <span>Planes Estudiantes</span>
            </button>
        </nav>

        <!-- Contenido de Pruebas -->
        <section class="tab-content active" id="pruebas-content" role="tabpanel" aria-labelledby="pruebas-tab">
            <!-- Filtros y Búsqueda -->
            <div class="filters-container" role="search">
                <div class="search-box">
                    <i class="bi bi-search" aria-hidden="true"></i>
                    <label for="searchPruebas" class="sr-only">Buscar pruebas</label>
                    <input type="text" id="searchPruebas" placeholder="Buscar por nombre de prueba..."
                        aria-label="Buscar por nombre de prueba">
                </div>
                <div class="filter-group">
                    <label for="filterNombrePrueba"><i class="bi bi-file-earmark-text" aria-hidden="true"></i>
                        Prueba:</label>
                    <select id="filterNombrePrueba" aria-label="Filtrar por nombre de prueba">
                        <option value="">Todas las pruebas</option>
                    </select>
                </div>
                <button class="btn-clear-filters" id="clearFiltersPruebas" aria-label="Limpiar todos los filtros">
                    <i class="bi bi-arrow-clockwise" aria-hidden="true"></i>
                    Limpiar Filtros
                </button>
            </div>

            <div class="results-grid" id="pruebasGrid" role="list" aria-label="Lista de pruebas realizadas">
                <div class="empty-state" role="status" aria-live="polite">
                    <i class="bi bi-hourglass-split" aria-hidden="true"></i>
                    <h3>Cargando pruebas...</h3>
                    <p>Por favor espera un momento</p>
                </div>
            </div>
        </section>

        <!-- Contenido de Minisimulacros -->
        <section class="tab-content" id="minisimulacros-content" role="tabpanel" aria-labelledby="minisimulacros-tab">
            <!-- Filtros y Búsqueda -->
            <div class="filters-container" role="search">
                <div class="search-box">
                    <i class="bi bi-search" aria-hidden="true"></i>
                    <label for="searchMinisimulacros" class="sr-only">Buscar minisimulacros</label>
                    <input type="text" id="searchMinisimulacros" placeholder="Buscar por nombre de minisimulacro..."
                        aria-label="Buscar por nombre de minisimulacro">
                </div>
                <div class="filter-group">
                    <label for="filterNombreMinisimu"><i class="bi bi-clipboard-check" aria-hidden="true"></i>
                        Simulacro:</label>
                    <select id="filterNombreMinisimu" aria-label="Filtrar por nombre de minisimulacro">
                        <option value="">Todos los simulacros</option>
                    </select>
                </div>
                <button class="btn-clear-filters" id="clearFiltersMinisimu" aria-label="Limpiar todos los filtros">
                    <i class="bi bi-arrow-clockwise" aria-hidden="true"></i>
                    Limpiar Filtros
                </button>
            </div>

            <div class="results-grid" id="minisimuGrid" role="list" aria-label="Lista de minisimulacros realizados">
                <div class="empty-state" role="status" aria-live="polite">
                    <i class="bi bi-hourglass-split" aria-hidden="true"></i>
                    <h3>Cargando minisimulacros...</h3>
                    <p>Por favor espera un momento</p>
                </div>
            </div>
        </section>

        <!-- Contenido de Plan de Estudio (Estudiantes) -->
        <section class="tab-content" id="plan-estudio-content" role="tabpanel" aria-labelledby="plan-estudio-tab">
            <!-- Lista de pruebas para plan de estudio -->
            <div class="plan-estudio-grid" id="planEstudioGrid" role="list" aria-label="Pruebas para plan de estudio">
                <!-- Las pruebas se cargarán dinámicamente -->
            </div>
        </section>

        <!-- Contenido de Planes de Estudio - Solo Admin -->
        <section class="tab-content" id="planes-admin-content" role="tabpanel" aria-labelledby="planes-admin-tab">
            <!-- Lista de planes de estudio (usa los filtros de arriba) -->
            <div class="planes-admin-grid" id="planesAdminGrid" role="list" aria-label="Planes de estudio de estudiantes">
                <!-- Los planes se cargarán dinámicamente -->
            </div>
        </section>
    </main>

    <!-- Firebase CDN -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js" defer></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11" defer></script>

    <script src="../Elementos/js/config.js"></script>
    <script src="../Elementos/js/resultados.js"></script>
</body>

</html>