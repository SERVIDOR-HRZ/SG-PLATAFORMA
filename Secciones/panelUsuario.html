<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuraci칩n de Usuario - Seamos Genios</title>

    <!-- Security headers -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="../Elementos/css/panel.css">
    <link rel="stylesheet" href="../Elementos/css/panel-usuario.css">
    <link rel="shortcut icon" href="../Elementos/img/logo1.png" type="image/x-icon">

</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <img src="../Elementos/img/logo1.png" alt="Seamos Genios Logo" class="header-logo">
            <h1>Configuraci칩n de Usuario</h1>
        </div>
        <div class="header-right">
            <div class="user-info" id="userInfoContainer">
                <span class="user-name" id="userName">USUARIO</span>
                <div class="user-avatar" id="userAvatarContainer">
                    <div class="user-avatar-default" id="userAvatarDefault">
                        <i class="bi bi-person-fill"></i>
                    </div>
                    <img class="user-avatar-image" id="userAvatarImage" style="display: none;" src=""
                        alt="Foto de perfil">
                </div>
                <div class="user-dropdown">
                    <button class="user-menu-btn" id="userMenuBtn">
                        <i class="bi bi-chevron-down"></i>
                    </button>
                    <div class="user-dropdown-menu" id="userDropdownMenu">
                        <button class="dropdown-item" id="logoutBtnDropdown">
                            <i class="bi bi-box-arrow-right"></i>
                            Cerrar Sesi칩n
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="configuracion-container">
            <!-- Navegaci칩n por pesta침as -->
            <div class="tabs-container">
                <button class="back-btn" id="backBtn">
                    <i class="bi bi-arrow-left"></i>
                    Volver
                </button>
                <button class="tab-btn active" data-tab="perfil">
                    <i class="bi bi-person-circle"></i>
                    Perfil
                </button>
                <button class="tab-btn" data-tab="recursos">
                    <i class="bi bi-trophy"></i>
                    Mis Recursos
                </button>
                <button class="tab-btn" data-tab="informacion">
                    <i class="bi bi-file-person"></i>
                    Informaci칩n
                </button>
                <button class="tab-btn" data-tab="seguridad">
                    <i class="bi bi-shield-lock"></i>
                    Seguridad
                </button>
                <button class="tab-btn" data-tab="musica">
                    <i class="bi bi-music-note-beamed"></i>
                    Mi M칰sica
                </button>
            </div>

            <!-- Tab Content: Perfil -->
            <div class="tab-content active" data-content="perfil">
                <!-- Secci칩n de Foto de Perfil -->
                <div class="perfil-seccion">
                    <h2>Foto de Perfil</h2>
                    <div class="foto-perfil-container">
                        <div class="foto-perfil-preview" id="fotoPerfilPreview">
                            <div class="foto-avatar" id="fotoAvatar">
                                <i class="bi bi-person-fill"></i>
                            </div>
                            <img class="foto-imagen" id="fotoImagen" style="display: none;" src="" alt="Foto de perfil">
                        </div>
                        <div class="foto-perfil-acciones">
                            <button class="btn btn-primary" id="cambiarFotoBtn">
                                <i class="bi bi-camera-fill"></i>
                                Cambiar Foto
                            </button>
                            <button class="btn btn-danger" id="eliminarFotoBtn" style="display: none;">
                                <i class="bi bi-trash-fill"></i>
                                Eliminar Foto
                            </button>
                            <p class="foto-ayuda">
                                <i class="bi bi-info-circle"></i>
                                Tama침o m치ximo: 5MB. Formatos: JPG, PNG, GIF
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab Content: Mis Recursos -->
            <div class="tab-content" data-content="recursos">
                <!-- Stats Cards de Recursos -->
                <div class="recursos-stats-grid">
                    <div class="recurso-stat-card monedas">
                        <div class="recurso-stat-icon">
                            <i class="bi bi-coin"></i>
                        </div>
                        <div class="recurso-stat-content">
                            <h3 id="totalMonedasUsuario">0</h3>
                            <p>Monedas</p>
                        </div>
                    </div>

                    <div class="recurso-stat-card insignias">
                        <div class="recurso-stat-icon">
                            <i class="bi bi-award-fill"></i>
                        </div>
                        <div class="recurso-stat-content">
                            <h3 id="totalInsigniasUsuario">0</h3>
                            <p>Insignias</p>
                        </div>
                    </div>

                    <div class="recurso-stat-card aulas">
                        <div class="recurso-stat-icon">
                            <i class="bi bi-door-open-fill"></i>
                        </div>
                        <div class="recurso-stat-content">
                            <h3 id="totalAulasUsuario">0</h3>
                            <p>Aulas Inscritas</p>
                        </div>
                    </div>
                </div>

                <!-- Secci칩n de Insignias -->
                <div class="recursos-seccion">
                    <h2>
                        <i class="bi bi-award-fill"></i>
                        Mis Insignias
                    </h2>
                    <div class="insignias-usuario-grid" id="insigniasUsuarioGrid">
                        <div class="loading-recursos">
                            <i class="bi bi-arrow-clockwise spin"></i>
                            <p>Cargando insignias...</p>
                        </div>
                    </div>
                    <div class="no-recursos" id="noInsigniasUsuario" style="display: none;">
                        <i class="bi bi-award"></i>
                        <p>A칰n no tienes insignias</p>
                        <small>Completa actividades para ganar insignias</small>
                    </div>
                </div>

                <!-- Secci칩n de Aulas Inscritas -->
                <div class="recursos-seccion">
                    <h2>
                        <i class="bi bi-door-open-fill"></i>
                        Mis Aulas
                    </h2>
                    <div class="aulas-usuario-grid" id="aulasUsuarioGrid">
                        <div class="loading-recursos">
                            <i class="bi bi-arrow-clockwise spin"></i>
                            <p>Cargando aulas...</p>
                        </div>
                    </div>
                    <div class="no-recursos" id="noAulasUsuario" style="display: none;">
                        <i class="bi bi-door-closed"></i>
                        <p>No est치s inscrito en ning칰n aula</p>
                        <small>Contacta a un administrador para inscribirte</small>
                    </div>
                </div>

                <!-- Historial de Monedas -->
                <div class="recursos-seccion">
                    <h2>
                        <i class="bi bi-clock-history"></i>
                        Historial de Monedas
                    </h2>
                    <div class="historial-monedas-list" id="historialMonedasUsuario">
                        <div class="loading-recursos">
                            <i class="bi bi-arrow-clockwise spin"></i>
                            <p>Cargando historial...</p>
                        </div>
                    </div>
                    <div class="no-recursos" id="noHistorialMonedas" style="display: none;">
                        <i class="bi bi-inbox"></i>
                        <p>No hay movimientos de monedas</p>
                    </div>
                </div>
            </div>

            <!-- Tab Content: Informaci칩n -->
            <div class="tab-content" data-content="informacion">
                <!-- Secci칩n de Informaci칩n Personal -->
                <div class="informacion-seccion">
                    <h2>Informaci칩n Personal</h2>
                    <form class="formulario-usuario" id="formularioUsuario">
                        <div class="form-grupo">
                            <label for="nombre">
                                <i class="bi bi-person"></i>
                                Nombre Completo
                            </label>
                            <input type="text" id="nombre" name="nombre" class="form-control" required>
                        </div>

                        <div class="form-grupo">
                            <label for="email">
                                <i class="bi bi-envelope"></i>
                                Correo Electr칩nico
                            </label>
                            <input type="email" id="email" name="email" class="form-control" readonly>
                        </div>

                        <div class="form-grupo">
                            <label for="emailRecuperacion">
                                <i class="bi bi-envelope-check"></i>
                                Correo de Recuperaci칩n
                            </label>
                            <input type="email" id="emailRecuperacion" name="emailRecuperacion" class="form-control" required>
                        </div>

                        <div class="form-grupo">
                            <label for="telefono">
                                <i class="bi bi-telephone"></i>
                                Tel칠fono
                            </label>
                            <input type="tel" id="telefono" name="telefono" class="form-control">
                        </div>

                        <div class="form-grupo">
                            <label for="fechaNacimiento">
                                <i class="bi bi-calendar-heart"></i>
                                Fecha de Nacimiento
                            </label>
                            <input type="date" id="fechaNacimiento" name="fechaNacimiento" class="form-control">
                        </div>

                        <div class="form-grupo">
                            <label for="tipoDocumento">
                                <i class="bi bi-card-text"></i>
                                Tipo de Documento
                            </label>
                            <select id="tipoDocumento" name="tipoDocumento" class="form-control">
                                <option value="">Seleccione</option>
                                <option value="CC">CC</option>
                                <option value="TI">TI</option>
                                <option value="CE">CE</option>
                                <option value="PA">PA</option>
                                <option value="NIT">NIT</option>
                            </select>
                        </div>

                        <div class="form-grupo">
                            <label for="numeroDocumento">
                                <i class="bi bi-123"></i>
                                N칰mero de Documento
                            </label>
                            <input type="text" id="numeroDocumento" name="numeroDocumento" class="form-control" placeholder="Ingrese su n칰mero de documento">
                        </div>

                        <div class="form-grupo">
                            <label for="tipoUsuario">
                                <i class="bi bi-shield-check"></i>
                                Tipo de Usuario
                            </label>
                            <input type="text" id="tipoUsuario" name="tipoUsuario" class="form-control" readonly>
                        </div>

                        <div class="form-grupo">
                            <label for="fechaCreacion">
                                <i class="bi bi-calendar"></i>
                                Miembro desde
                            </label>
                            <input type="text" id="fechaCreacion" name="fechaCreacion" class="form-control" readonly>
                        </div>

                        <div class="form-acciones">
                            <button type="button" class="btn btn-secondary" id="cancelarBtn">
                                <i class="bi bi-x-circle"></i>
                                Cancelar
                            </button>
                            <button type="submit" class="btn btn-success">
                                <i class="bi bi-check-circle"></i>
                                Guardar Cambios
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Secci칩n de Informaci칩n P칰blica -->
                <div class="informacion-publica-seccion">
                    <h2>Informaci칩n P칰blica del Perfil</h2>
                    <p class="seccion-descripcion">Esta informaci칩n ser치 visible para otros usuarios de la plataforma
                    </p>
                    <form class="formulario-publico" id="formularioPublico">
                        <div class="form-grupo full-width">
                            <label for="biografia">
                                <i class="bi bi-file-text"></i>
                                Biograf칤a / Descripci칩n
                            </label>
                            <textarea id="biografia" name="biografia" class="form-control textarea-biografia" rows="4"
                                maxlength="500"
                                placeholder="Cu칠ntanos un poco sobre ti (m치ximo 500 caracteres)"></textarea>
                            <small class="char-counter" id="bioCharCounter">0 / 500 caracteres</small>
                        </div>

                        <div class="form-grupo">
                            <label for="profesion">
                                <i class="bi bi-briefcase"></i>
                                Profesi칩n / Cargo
                            </label>
                            <input type="text" id="profesion" name="profesion" class="form-control"
                                placeholder="Ej: Profesor de Matem치ticas, Estudiante de 11춿">
                        </div>

                        <div class="form-grupo">
                            <label for="especialidad">
                                <i class="bi bi-star"></i>
                                Especialidad / 츼rea de Inter칠s
                            </label>
                            <input type="text" id="especialidad" name="especialidad" class="form-control"
                                placeholder="Ej: C치lculo, F칤sica, Literatura">
                        </div>

                        <div class="form-grupo">
                            <label for="ciudad">
                                <i class="bi bi-geo-alt"></i>
                                Ciudad
                            </label>
                            <input type="text" id="ciudad" name="ciudad" class="form-control"
                                placeholder="Ej: Bogot치, Medell칤n">
                        </div>

                        <div class="form-grupo">
                            <label for="institucionPublica">
                                <i class="bi bi-building"></i>
                                Instituci칩n Educativa
                            </label>
                            <input type="text" id="institucionPublica" name="institucionPublica" class="form-control"
                                placeholder="Nombre de tu instituci칩n">
                        </div>

                        <div class="redes-sociales-grupo">
                            <h3>
                                <i class="bi bi-share"></i>
                                Redes Sociales (Opcional)
                            </h3>
                            <div class="redes-grid">
                                <div class="form-grupo">
                                    <label for="linkedin">
                                        <i class="bi bi-linkedin"></i>
                                        LinkedIn
                                    </label>
                                    <input type="url" id="linkedin" name="linkedin" class="form-control"
                                        placeholder="https://linkedin.com/in/tu-perfil">
                                </div>

                                <div class="form-grupo">
                                    <label for="twitter">
                                        <i class="bi bi-twitter"></i>
                                        Twitter
                                    </label>
                                    <input type="text" id="twitter" name="twitter" class="form-control"
                                        placeholder="@tuusuario">
                                </div>

                                <div class="form-grupo">
                                    <label for="instagram">
                                        <i class="bi bi-instagram"></i>
                                        Instagram
                                    </label>
                                    <input type="text" id="instagram" name="instagram" class="form-control"
                                        placeholder="@tuusuario">
                                </div>

                                <div class="form-grupo">
                                    <label for="facebook">
                                        <i class="bi bi-facebook"></i>
                                        Facebook
                                    </label>
                                    <input type="url" id="facebook" name="facebook" class="form-control"
                                        placeholder="https://facebook.com/tu-perfil">
                                </div>
                            </div>
                        </div>

                        <div class="form-acciones">
                            <button type="button" class="btn btn-secondary" id="cancelarPublicoBtn">
                                <i class="bi bi-x-circle"></i>
                                Cancelar
                            </button>
                            <button type="submit" class="btn btn-success">
                                <i class="bi bi-check-circle"></i>
                                Guardar Informaci칩n P칰blica
                            </button>
                        </div>
                    </form>
                </div>
            </div>



            <!-- Tab Content: Seguridad -->
            <div class="tab-content" data-content="seguridad">
                <!-- Secci칩n de Cambio de Contrase침a -->
                <div class="password-seccion">
                    <h2>Cambiar Contrase침a</h2>
                    <form class="formulario-password" id="formularioPassword">
                        <div class="form-grupo">
                            <label for="passwordActual">
                                <i class="bi bi-lock"></i>
                                Contrase침a Actual
                            </label>
                            <div class="password-input-grupo">
                                <input type="password" id="passwordActual" name="passwordActual" class="form-control"
                                    required>
                                <button type="button" class="toggle-password" data-target="passwordActual">
                                    <i class="bi bi-eye"></i>
                                </button>
                            </div>
                        </div>

                        <div class="form-grupo">
                            <label for="passwordNueva">
                                <i class="bi bi-lock-fill"></i>
                                Contrase침a Nueva
                            </label>
                            <div class="password-input-grupo">
                                <input type="password" id="passwordNueva" name="passwordNueva" class="form-control"
                                    required minlength="6">
                                <button type="button" class="toggle-password" data-target="passwordNueva">
                                    <i class="bi bi-eye"></i>
                                </button>
                            </div>
                            <small class="form-texto-ayuda">M칤nimo 6 caracteres</small>
                        </div>

                        <div class="form-grupo">
                            <label for="passwordConfirmar">
                                <i class="bi bi-lock-fill"></i>
                                Confirmar Contrase침a Nueva
                            </label>
                            <div class="password-input-grupo">
                                <input type="password" id="passwordConfirmar" name="passwordConfirmar"
                                    class="form-control" required>
                                <button type="button" class="toggle-password" data-target="passwordConfirmar">
                                    <i class="bi bi-eye"></i>
                                </button>
                            </div>
                        </div>

                        <div class="form-acciones">
                            <button type="submit" class="btn btn-warning">
                                <i class="bi bi-key-fill"></i>
                                Cambiar Contrase침a
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Tab Content: M칰sica -->
            <div class="tab-content" data-content="musica">
                <!-- Secci칩n de Playlist Personal -->
                <div class="musica-seccion">
                    <h2>
                        <i class="bi bi-music-note-list"></i>
                        Mi Playlist Personalizada
                    </h2>
                    <p class="seccion-descripcion">
                        Crea tu propia playlist con m칰sica de YouTube para escuchar durante las pruebas.
                        Agrega canciones relajantes, instrumentales o lo que te ayude a concentrarte.
                    </p>

                    <!-- Agregar Nueva Canci칩n -->
                    <div class="agregar-cancion-container">
                        <h3>
                            <i class="bi bi-plus-circle"></i>
                            Agregar Nueva Canci칩n
                        </h3>
                        <form class="formulario-agregar-cancion" id="formularioAgregarCancion">
                            <div class="form-grupo-inline">
                                <div class="form-grupo flex-grow">
                                    <label for="youtubeUrl">
                                        <i class="bi bi-youtube"></i>
                                        URL de YouTube
                                    </label>
                                    <input type="text" id="youtubeUrl" name="youtubeUrl" class="form-control"
                                        placeholder="https://youtu.be/glYtuMeMOfs o https://www.youtube.com/watch?v=..."
                                        required>
                                    <small class="form-texto-ayuda">
                                        游눠 <strong>Recomendaci칩n:</strong> Usa el bot칩n "Probar" para ver si el video funciona antes de agregarlo.
                                        El sistema verificar치 autom치ticamente si se puede reproducir embebido.
                                    </small>
                                </div>
                                <div class="form-grupo">
                                    <label for="tituloCancion">
                                        <i class="bi bi-card-text"></i>
                                        T칤tulo (Opcional)
                                    </label>
                                    <input type="text" id="tituloCancion" name="tituloCancion" class="form-control"
                                        placeholder="Se detectar치 autom치ticamente desde YouTube">
                                </div>
                                <div class="form-grupo-boton">
                                    <button type="button" class="btn btn-info" id="probarVideoBtn" style="margin-right: 10px;">
                                        <i class="bi bi-play-circle"></i>
                                        Probar
                                    </button>
                                    <button type="submit" class="btn btn-success">
                                        <i class="bi bi-plus-lg"></i>
                                        Agregar
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>

                    <!-- Lista de Canciones -->
                    <div class="playlist-container">
                        <div class="playlist-header">
                            <h3>
                                <i class="bi bi-list-ul"></i>
                                Tu Playlist
                                <span class="playlist-count" id="playlistCount">(0 canciones)</span>
                            </h3>
                            <div class="playlist-acciones">
                                <button class="btn btn-secondary btn-sm" id="restaurarPlaylistBtn">
                                    <i class="bi bi-arrow-clockwise"></i>
                                    Restaurar Playlist por Defecto
                                </button>
                                <button class="btn btn-primary btn-sm" id="guardarPlaylistBtn">
                                    <i class="bi bi-save"></i>
                                    Guardar Playlist
                                </button>
                            </div>
                        </div>

                        <div class="playlist-items" id="playlistItems">
                            <!-- Las canciones se cargar치n aqu칤 din치micamente -->
                            <div class="playlist-empty" id="playlistEmpty">
                                <i class="bi bi-music-note-beamed"></i>
                                <p>No hay canciones en tu playlist</p>
                                <p class="text-muted">Agrega tu primera canci칩n usando el formulario arriba</p>
                            </div>
                        </div>
                    </div>

                    <!-- Playlist por Defecto -->
                    <div class="playlist-info-box">
                        <i class="bi bi-info-circle"></i>
                        <div>
                            <strong>Consejos:</strong>
                            <ul>
                                <li><strong>游눠 USA EL BOT칍N "PROBAR"</strong> para verificar que el video funcione antes de agregarlo</li>
                                <li>Busca m칰sica instrumental, lo-fi o ambiental en YouTube</li>
                                <li>Evita canciones con letra que puedan distraerte</li>
                                <li>Puedes agregar hasta 20 canciones</li>
                                <li>La playlist se reproducir치 en orden durante tus pruebas</li>
                                <li><strong>丘멆잺 Solo se pueden agregar videos que permitan reproducci칩n embebida</strong></li>
                                <li>El sistema verificar치 autom치ticamente cada video, pero puede haber falsos positivos</li>
                                <li>El t칤tulo se detectar치 autom치ticamente desde YouTube</li>
                                <li>Si un video muestra error al reproducir, busca otro del mismo artista o tema</li>
                                <li>Los videos de canales independientes suelen funcionar mejor que los de discogr치ficas</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>



    <!-- Modal: Confirmar Eliminaci칩n -->
    <div class="modal-overlay" id="confirmarEliminarModal">
        <div class="modal-dialog modal-sm">
            <div class="modal-header">
                <h3>Confirmar Eliminaci칩n</h3>
            </div>
            <div class="modal-body text-center">
                <i class="bi bi-exclamation-triangle" style="font-size: 48px; color: #ffc107; margin-bottom: 20px;"></i>
                <p id="confirmarEliminarMensaje">쮼st치s seguro de eliminar este elemento?</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancelarEliminarBtn">
                    <i class="bi bi-x-lg"></i>
                    Cancelar
                </button>
                <button type="button" class="btn btn-danger" id="confirmarEliminarBtn">
                    <i class="bi bi-trash"></i>
                    Eliminar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal: Reproductor de Vista Previa -->
    <div class="modal-overlay" id="modalReproductorPreview" style="display: none;">
        <div class="modal-dialog modal-video">
            <div class="modal-header">
                <h3 id="modalReproductorTitulo">Vista Previa de Canci칩n</h3>
                <button type="button" class="btn-close-modal" id="cerrarReproductorPreview">
                    <i class="bi bi-x-lg"></i>
                </button>
            </div>
            <div class="modal-body modal-body-video">
                <div class="video-container" id="videoPreviewContainer">
                    <div class="video-loading">
                        <div class="loading-spinner"></div>
                        <p>Cargando video...</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cerrarPreviewBtn">
                    <i class="bi bi-x-circle"></i>
                    Cerrar
                </button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay" style="display: none;">
        <div class="loading-spinner"></div>
        <p class="loading-texto">Cargando...</p>
    </div>



    <!-- Firebase CDN -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <!-- YouTube IFrame API -->
    <script>
        // Variable global para el callback de YouTube API
        var onYouTubeIframeAPIReady = function() {
            console.log('YouTube IFrame API est치 lista');
            window.youtubeAPIReady = true;
        };
    </script>

    <script src="../Elementos/js/config.js"></script>
    <script src="../Elementos/js/panel-usuario.js"></script>
</body>

</html>